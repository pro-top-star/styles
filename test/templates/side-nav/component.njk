{% from "./../icon/component.njk" import icon %}
<!--
nav.fd-side-nav
    div.fd-side-nav__group
        h1.fd-side-nav__title
        ul.fd-side-nav__list
            li.fd-side-nav__item
                a.fd-side-nav__link (.has-child, .is-active, .is-expanded)
                ul.fd-side-nav__sublist
                    li.fd-side-nav__subitem
                    a.fd-side-nav__sublink
-->

{%- macro navitem(properties={}) -%}
    <li class="fd-side-nav__item">
        {%- set selected, haschild, isexpanded = "" -%}
        {%- if properties.state.selected -%}
            {%- set selected = "is-selected" %}
        {%- endif -%}
        {%- if properties.state.haschild -%}
            {%- set haschild = "has-child" %}
        {%- endif -%}
        {%- if properties.state.isexpanded -%}
            {%- set isexpanded = "is-expanded" %}
        {%- endif -%}

        <a class="fd-side-nav__link {{ selected }} {{ haschild }} {{ isexpanded }}"{{ aria | aria }} href="{{ properties.href or '#' }}">
            {{ properties.label }}
        </a>
        {%- if properties.items -%}
        <ul class="fd-side-nav__sublist" aria-hidden="true">
            {%- for subitem in properties.items %}
                <li class="fd-side-nav__subitem">
                    {%- if subitem.state.selected -%}
                        {%- set subselected = "is-selected" %}
                    {%- else -%}
                        {%- set subselected = "" %}
                    {%- endif -%}
                    <a class="fd-side-nav__sublink {{ subselected }}"{{ aria | aria }} href="{{ item.href or '#' }}">
                        {{ subitem.label }}
                    </a>
                </li>
            {%- endfor -%}
        </ul>
        {%- endif -%}
    </li>
{%- endmacro %}

{%- macro navlist(properties={}) -%}
<ul class="fd-side-nav__list">
    {%- for item in properties %}
        {{ navitem(item) }}
    {%- endfor -%}
</ul>
{%- endmacro %}

{%- macro navgroup(properties={}) -%}
    {%- for navgroup in properties -%}
    <div class="fd-side-nav__group">
        <h1 class="fd-side-nav__title">{{ navgroup.title }}</h1>
        {{ navlist(navgroup.items) }}
    </div>
    {%- endfor -%}
{%- endmacro %}

{%- macro side_nav(properties={}, modifier={}, state={}, aria={}, classes="") -%}
    <nav class="fd-side-nav">
        {%- if properties.navgroups  %}
            {{ navgroup(properties.navgroups) }}
        {%- else -%}
            {{ navlist(properties.items) }}
        {%- endif -%}
    </nav>
{%- endmacro -%}
